<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forma√ß√£o Node.js - Udemy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .video-gradient {
            background: linear-gradient(45deg, #9c27b0, #673ab7, #3f51b5, #2196f3);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .play-button {
            transition: all 0.3s ease;
        }
        .play-button:hover {
            transform: scale(1.1);
        }
        
        /* Mobile sidebar overlay */
        .sidebar-overlay {
            background: rgba(0, 0, 0, 0.5);
        }
        
        /* Custom scrollbar for sidebar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #374151;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #6b7280;
            border-radius: 3px;
        }
        
        /* Video responsive aspect ratio */
        .video-aspect {
            aspect-ratio: 16/9;
        }
        
        @media (max-width: 768px) {
            .mobile-header {
                padding: 0.75rem 1rem;
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Header -->
    <header class="bg-gray-900 border-b border-gray-700 mobile-header">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-2 md:space-x-6">
                <div class="flex items-center space-x-2">
                    <span class="text-purple-400 text-lg md:text-2xl font-bold truncate">CURSO PARA DI√ÅCONOS E AUXILIARES | <%= nome_materia %></span>
                    <div class="hidden md:block h-6 w-px bg-gray-600"></div>
                </div>
            </div>
            <!-- Mobile menu button -->
            <button id="mobile-menu-btn" class="md:hidden p-2 text-gray-400 hover:text-white">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </div>
    </header>

    <div class="flex flex-col md:flex-row h-screen">
        <!-- Main Content -->
        <div class="flex-1 flex flex-col order-1 md:order-none">
            <!-- Video Player -->
            <div class="relative bg-black video-aspect md:flex-1">
                <!-- YouTube Video Container -->
                <div id="video-container" class="w-full h-full hidden">
                    <iframe id="youtube-frame" 
                            class="w-full h-full" 
                            src="" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                    </iframe>
                </div>
                
                <!-- Default Placeholder -->
                <div id="video-placeholder" class="video-gradient w-full h-full flex items-center justify-center relative overflow-hidden">
                    <!-- Decorative circles - responsive sizes -->
                    <div class="absolute top-4 left-4 md:top-20 md:left-20 w-16 h-16 md:w-32 md:h-32 border-2 border-white/20 rounded-full"></div>
                    <div class="absolute top-8 right-8 md:top-40 md:right-32 w-24 h-24 md:w-48 md:h-48 border border-white/10 rounded-full"></div>
                    <div class="absolute bottom-8 left-8 md:bottom-32 md:left-40 w-32 h-32 md:w-64 md:h-64 border border-white/5 rounded-full"></div>
                    <div class="absolute top-2 right-2 md:top-10 md:right-10 w-8 h-8 md:w-16 md:h-16 border-2 border-white/30 rounded-full"></div>
                    
                    <!-- Play button and content -->
                    <div class="relative z-10 text-center px-4">
                        <button class="play-button w-16 h-16 md:w-20 md:h-20 bg-black bg-opacity-70 rounded-full flex items-center justify-center mb-4 md:mb-8 mx-auto hover:bg-opacity-90">
                            <i class="fas fa-play text-white text-xl md:text-2xl ml-1"></i>
                        </button>
                        <h1 id="video-title" class="text-2xl md:text-5xl font-bold mb-2 md:mb-4">CURSO PARA DI√ÅCONOS</h1>
                        <p id="video-subtitle" class="text-sm md:text-xl text-white/90">Clique em uma aula para come√ßar</p>
                    </div>
                </div>

                <!-- Video Controls -->
                <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2 md:p-4">
                    <div class="flex items-center space-x-2 md:space-x-4">
                        <button class="text-white hover:text-purple-400 p-1">
                            <i class="fas fa-step-backward text-sm md:text-base"></i>
                        </button>
                        <button class="text-white hover:text-purple-400 p-1">
                            <i class="fas fa-play text-sm md:text-base"></i>
                        </button>
                        <span class="text-xs md:text-sm">0:00 / 0:00</span>
                        <div class="flex-1 bg-gray-600 h-1 rounded mx-2">
                            <div class="bg-purple-500 h-1 rounded" style="width: 0%"></div>
                        </div>
                        <div class="flex items-center space-x-1 md:space-x-2">
                            <button class="text-white hover:text-purple-400 p-1">
                                <i class="fas fa-volume-up text-sm md:text-base"></i>
                            </button>
                            <button class="hidden md:block text-white hover:text-purple-400 p-1">
                                <i class="fas fa-cog text-sm md:text-base"></i>
                            </button>
                            <button class="text-white hover:text-purple-400 p-1">
                                <i class="fas fa-expand text-sm md:text-base"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Course Info -->
            <div class="bg-gray-900 p-3 md:p-6 border-t border-gray-700">
                <div class="flex flex-wrap gap-2 md:gap-8 text-xs md:text-sm text-gray-400 mb-3 md:mb-4 overflow-x-auto">
                    <button class="text-white border-b-2 border-purple-500 pb-1 md:pb-2 whitespace-nowrap">Vis√£o geral</button>
                    <button class="hover:text-white whitespace-nowrap">Perguntas e respostas</button>
                    <button class="hover:text-white whitespace-nowrap hidden md:block">Observa√ß√µes</button>
                    <button class="hover:text-white whitespace-nowrap hidden md:block">An√∫ncios</button>
                    <button class="hover:text-white whitespace-nowrap">Avalia√ß√µes</button>
                    <button class="hover:text-white whitespace-nowrap hidden sm:block">Ferramentas de aprendizado</button>
                </div>
                <h2 class="text-lg md:text-xl font-bold mb-2">Curso completo para di√°conos e auxiliares, abordando fundamentos teol√≥gicos e pr√°ticos do minist√©rio.</h2>
                <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-6 text-xs md:text-sm">
                    <div class="flex items-center space-x-2">
                        <span class="text-yellow-400">4,9 ‚≠ê</span>
                        <span>2.847 classifica√ß√µes</span>
                    </div>
                    <div>
                        <span class="font-bold">8.234</span>
                        <span class="text-gray-400">Alunos</span>
                    </div>
                    <div>
                        <span class="font-bold">2h 15m</span>
                        <span class="text-gray-400">Total</span>
                    </div>
                </div>
                <div class="mt-3 md:mt-4 text-xs md:text-sm text-gray-400 space-y-1">
                    <p><i class="fas fa-clock mr-2"></i>√öltima atualiza√ß√£o em janeiro de 2024</p>
                    <p><i class="fas fa-globe mr-2"></i>Portugu√™s <span class="bg-gray-700 px-2 py-1 rounded text-xs ml-2">Original</span></p>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div id="sidebar" class="fixed md:relative inset-y-0 right-0 z-50 w-80 md:w-96 bg-gray-800 border-l border-gray-700 flex flex-col transform translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out">
            <div class="p-3 md:p-4 border-b border-gray-700">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="font-bold text-sm md:text-base">Conte√∫do do curso</h3>
                    <button id="close-sidebar" class="text-gray-400 hover:text-white md:hidden">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto custom-scrollbar">
                <!-- Course lessons list -->
                <div class="lessons-list">
                    
                    <% aulas.forEach(dados=>{ %>
                    <div class="lesson-item p-4 md:p-5 hover:bg-gray-700 cursor-pointer bg-purple-900/30 border-l-4 border-purple-500 active-lesson border-b border-gray-700" 
                         data-video="iYM2zFP3Zn0" 
                         data-title="Minist√©rio Pr√°tico" 
                         data-subtitle="Visita√ß√£o, cuidado pastoral e administra√ß√£o eclesi√°stica">
                        <div class="flex items-center space-x-4 md:space-x-5">
                            <i class="fas fa-play-circle text-purple-400 text-xl"></i>
                            <div class="flex-1">
                                <span class="text-base md:text-lg block font-medium"><%= dados.descricao %></span>
								
                            </div>
                            <div class="lesson-actions hidden">
                                <button class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm transition-colors">
                                    <i class="fas fa-check mr-1"></i>
									<p><div id="timer"></div></p>
                                    Concluir
                                </button>
                            </div>
                        </div>
                    </div>
                    <% }) %>
                    
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Add some interactivity
        document.addEventListener('DOMContentLoaded', function() {
            const videoContainer = document.getElementById('video-container');
            const videoPlaceholder = document.getElementById('video-placeholder');
            const youtubeFrame = document.getElementById('youtube-frame');
            const videoTitle = document.getElementById('video-title');
            const videoSubtitle = document.getElementById('video-subtitle');

            // Play button animation
            const playButton = document.querySelector('.play-button');
            if (playButton) {
                playButton.addEventListener('click', function() {
                    this.innerHTML = '<i class="fas fa-pause text-white text-2xl"></i>';
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-play text-white text-2xl ml-1"></i>';
                    }, 2000);
                });
            }

            // Function to load video
            function loadVideo(videoId, title, subtitle) {
                // Check if running locally (file:// protocol)
                const isLocal = window.location.protocol === 'file:';
                
                if (isLocal) {
                    // For local files, show a message and open YouTube in new tab
                    videoPlaceholder.classList.remove('hidden');
                    videoContainer.classList.add('hidden');
                    
                    // Update the placeholder with video info and open button
                    const placeholder = document.getElementById('video-placeholder');
                    placeholder.innerHTML = `
                        <div class="relative z-10 text-center">
                            <div class="w-20 h-20 bg-red-600 rounded-full flex items-center justify-center mb-6 mx-auto">
                                <i class="fab fa-youtube text-white text-3xl"></i>
                            </div>
                            <h1 class="text-4xl font-bold mb-4">${title}</h1>
                            <p class="text-xl text-white/90 mb-6">${subtitle}</p>
                            <button onclick="window.open('https://youtube.com/watch?v=${videoId}', '_blank')" 
                                    class="bg-red-600 hover:bg-red-700 px-6 py-3 rounded-lg font-medium transition-colors">
                                <i class="fab fa-youtube mr-2"></i>
                                Assistir no YouTube
                            </button>
                            <p class="text-sm text-white/70 mt-4">
                                <i class="fas fa-info-circle mr-1"></i>
                                Para p√°ginas locais, o v√≠deo abrir√° no YouTube
                            </p>
                        </div>
                    `;
                } else {
                    // For served pages, embed normally
                    const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=0&rel=0&origin=${window.location.origin}`;
                    youtubeFrame.src = embedUrl;
                    videoContainer.classList.remove('hidden');
                    videoPlaceholder.classList.add('hidden');
                }
                
                videoTitle.textContent = title;
                videoSubtitle.textContent = subtitle;

                // Update active lesson
                document.querySelectorAll('.lesson-item').forEach(item => {
                    item.classList.remove('active-lesson', 'bg-purple-900/30', 'border-l-4', 'border-purple-500');
                    const icon = item.querySelector('i');
                    icon.classList.remove('text-purple-400');
                    icon.classList.add('text-gray-400');
                    
                    // Hide action buttons
                    const actions = item.querySelector('.lesson-actions');
                    if (actions) {
                        actions.classList.add('hidden');
                        // Reset button to "Assistir"
                        const button = actions.querySelector('button');
                        if (button) {
                            button.innerHTML = '<i class="fas fa-play mr-1"></i>Assistir';
                            button.disabled = false;
                            button.classList.remove('opacity-50', 'cursor-not-allowed', 'animate-pulse');
                            button.title = '';
                        }
                    }
                });

                // Mark current lesson as active
                const currentLesson = document.querySelector(`[data-video="${videoId}"]`);
                if (currentLesson) {
                    currentLesson.classList.add('active-lesson', 'bg-purple-900/30', 'border-l-4', 'border-purple-500');
                    const icon = currentLesson.querySelector('i');
                    icon.classList.remove('text-gray-400');
                    icon.classList.add('text-purple-400');
                    
                    // Show action button for active lesson
                    const actions = currentLesson.querySelector('.lesson-actions');
                    if (actions) {
                        actions.classList.remove('hidden');
                        // Change button to "Concluir" for active lesson
                        const button = actions.querySelector('button');
                        if (button) {
                            button.innerHTML = '<i class="fas fa-check mr-1"></i>Concluir';
                            button.disabled = true;
                            button.classList.add('opacity-50', 'cursor-not-allowed');
                            button.title = 'Aguarde 10 segundos para concluir';
                            
                            // Enable button after 10 seconds
                            setTimeout(() => {
                                button.disabled = false;
                                button.classList.remove('opacity-50', 'cursor-not-allowed');
                                button.title = 'Clique para concluir a aula';
                                
                                // Add visual feedback that button is now clickable
                                button.classList.add('animate-pulse');
                                setTimeout(() => {
                                    button.classList.remove('animate-pulse');
                                }, 2000);
                            }, 10000); // 10 seconds
                        }
                    }
                }
            }
			function enviarPresenca(){
				alert('presenca')
				let uid_usuario = $("#uid_usuario").val();
				let id_aula = $("#id_aula").val();
				
				
				console.log(uid_usuario);
				console.log(id_aula);
				
			}
			
			
            // Function to mark lesson as completed
            function markLessonAsCompleted(lessonElement) {
                // Add completed styling
                lessonElement.classList.add('lesson-completed');
                //const button = lessonElement.querySelector('.lesson-actions button');
                //if (button) {
                    //button.innerHTML = '<i class="fas fa-redo mr-1"></i>Revisar';
                    //button.classList.remove('bg-green-600', 'hover:bg-green-700');
                    //button.classList.add('bg-gray-600', 'hover:bg-gray-700');
                    //button.disabled = true;
                    //button.classList.remove('opacity-50', 'cursor-not-allowed', 'animate-pulse');
                    //button.title = 'Clique para revisar a aula';
                //}
				
				
                // Add checkmark icon
                /*const icon = lessonElement.querySelector('i');
                icon.classList.remove('fa-play-circle', 'text-purple-400');
                icon.classList.add('fa-check-circle', 'text-green-400');
                */
                // Update button to show completed state
                /*const button = lessonElement.querySelector('.lesson-actions button');
                if (button) {
                    button.innerHTML = '<i class="fas fa-redo mr-1"></i>Revisar';
                    button.classList.remove('bg-green-600', 'hover:bg-green-700');
                    button.classList.add('bg-gray-600', 'hover:bg-gray-700');
                    button.disabled = false;
                    button.classList.remove('opacity-50', 'cursor-not-allowed', 'animate-pulse');
                    button.title = 'Clique para revisar a aula';
                }
                */
                // Add completion badge
                /*const titleSpan = lessonElement.querySelector('span.block');
                if (titleSpan && !titleSpan.querySelector('.completion-badge')) {
                    const badge = document.createElement('span');
                    badge.className = 'completion-badge inline-block bg-green-500 text-white text-xs px-2 py-1 rounded ml-2';
                    badge.innerHTML = '<i class="fas fa-check mr-1"></i>Conclu√≠da';
                    titleSpan.appendChild(badge);
                }*/
            }

            // Function to show placeholder
            function showPlaceholder() {
                videoContainer.classList.add('hidden');
                videoPlaceholder.classList.remove('hidden');
                youtubeFrame.src = '';
                
                // Restore original placeholder content
                const placeholder = document.getElementById('video-placeholder');
                placeholder.innerHTML = `
                    <!-- Decorative circles -->
                    <div class="absolute top-20 left-20 w-32 h-32 border-2 border-white/20 rounded-full"></div>
                    <div class="absolute top-40 right-32 w-48 h-48 border border-white/10 rounded-full"></div>
                    <div class="absolute bottom-32 left-40 w-64 h-64 border border-white/5 rounded-full"></div>
                    <div class="absolute top-10 right-10 w-16 h-16 border-2 border-white/30 rounded-full"></div>
                    
                    <!-- Play button and content -->
                    <div class="relative z-10 text-center">
                        <button class="play-button w-20 h-20 bg-black bg-opacity-70 rounded-full flex items-center justify-center mb-8 mx-auto hover:bg-opacity-90">
                            <i class="fas fa-play text-white text-2xl ml-1"></i>
                        </button>
                        <h1 id="video-title" class="text-5xl font-bold mb-4">CURSO PARA DI√ÅCONOS</h1>
                        <p id="video-subtitle" class="text-xl text-white/90">Clique em uma aula para come√ßar</p>
                    </div>
                `;
            }

            // Lesson click handlers
            document.querySelectorAll('.lesson-item').forEach(lesson => {
                lesson.addEventListener('click', function(e) {
                    // Prevent triggering lesson click when clicking on button
                    if (e.target.closest('.lesson-actions')) {
                        return;
                    }
                    
                    const videoId = this.dataset.video;
                    const title = this.dataset.title;
                    const subtitle = this.dataset.subtitle;
                    loadVideo(videoId, title, subtitle);
                });
            });

            // Action button handlers
            document.addEventListener('click', function(e) {
                if (e.target.closest('.lesson-actions button')) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const button = e.target.closest('button');
                    const lessonItem = button.closest('.lesson-item');
                    const videoId = lessonItem.dataset.video;
                    const title = lessonItem.dataset.title;
                    const subtitle = lessonItem.dataset.subtitle;
                    
                    if (button.innerHTML.includes('play')) {
                        // Start video
                        loadVideo(videoId, title, subtitle);
                    } else if (button.innerHTML.includes('check') || button.innerHTML.includes('Concluir')) {
                        // Check if button is disabled (within 10 seconds)
                        if (button.disabled) {
                            alert('Aguarde alguns segundos antes de concluir a aula!');
                            return;
                        }
                        
                        // Complete lesson with alert
                        alert('üéâ Parab√©ns! Aula conclu√≠da com sucesso!');
                        
                        // Mark lesson as completed and move to next
                        markLessonAsCompleted(lessonItem);
						enviarPresenca();
                        showPlaceholder();
                    }
                }
            });

            // Removed accordion functionality - now showing all lessons as list

            // Back to course overview
            document.querySelector('[href="#"]')?.addEventListener('click', function(e) {
                e.preventDefault();
                showPlaceholder();
                
                // Remove all active lesson styling
                document.querySelectorAll('.lesson-item').forEach(item => {
                    item.classList.remove('active-lesson', 'bg-purple-900/30', 'border-l-4', 'border-purple-500');
                    const icon = item.querySelector('i');
                    icon.classList.remove('text-purple-400');
                    icon.classList.add('text-gray-400');
                    
                    // Hide all action buttons
                    const actions = item.querySelector('.lesson-actions');
                    if (actions) {
                        actions.classList.add('hidden');
                    }
                });
                
                // Reset to default title
                videoTitle.textContent = 'CURSO PARA DI√ÅCONOS';
                videoSubtitle.textContent = 'Clique em uma aula para come√ßar';
            });

            // Tab navigation
            document.querySelectorAll('button[class*="border-b"]').forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active state from all tabs
                    document.querySelectorAll('button[class*="border-b"]').forEach(t => {
                        t.classList.remove('text-white', 'border-purple-500');
                        t.classList.add('text-gray-400', 'hover:text-white');
                    });
                    
                    // Add active state to clicked tab
                    this.classList.remove('text-gray-400', 'hover:text-white');
                    this.classList.add('text-white', 'border-b-2', 'border-purple-500', 'pb-2');
                });
            });
            // Mobile sidebar functionality
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const sidebar = document.getElementById('sidebar');
            const closeSidebar = document.getElementById('close-sidebar');
            
            // Create overlay for mobile
            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 z-40 hidden';
            overlay.id = 'sidebar-overlay';
            document.body.appendChild(overlay);

            function openSidebar() {
                sidebar.classList.remove('translate-x-full');
                overlay.classList.remove('hidden');
                document.body.classList.add('overflow-hidden');
            }

            function closeSidebarFunc() {
                sidebar.classList.add('translate-x-full');
                overlay.classList.add('hidden');
                document.body.classList.remove('overflow-hidden');
            }

            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', openSidebar);
            }

            if (closeSidebar) {
                closeSidebar.addEventListener('click', closeSidebarFunc);
            }

            overlay.addEventListener('click', closeSidebarFunc);

            // Close sidebar when clicking on a lesson (mobile only)
            document.querySelectorAll('.lesson-item').forEach(lesson => {
                lesson.addEventListener('click', function() {
                    if (window.innerWidth < 768) {
                        closeSidebarFunc();
                    }
                });
            });

            // Handle window resize
            window.addEventListener('resize', function() {
                if (window.innerWidth >= 768) {
                    closeSidebarFunc();
                }
            });
        });
    </script>
	<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script>
		$(function () {
		
			var duration = 60 * 40; // Converter para segundos
			display = document.querySelector('#timer'); // selecionando o timer
			startTimer(duration, display); // iniciando o timer
		
			//document.getElementById("concluirAula").disabled = true;
			setTimeout(() => {
				//document.getElementById("concluirAula").disabled = false;
				
			}, "2400000");
			
			/*
			
			$("#concluirAula").click(function(){
			
				let uid_usuario = $("#uid_usuario").val();
				let id_aula = $("#id_aula").val();
				
				
				console.log(uid_usuario);
				console.log(id_aula);
				
				
				$.post('/user/presenca', {
					uid_usuario: uid_usuario,
					id_aula: id_aula
				}, function(resposta) {
					console.log(resposta);
					window.location.reload(true);
					
				});
				

			})*/
			
			function startTimer(duration, display) {
				var timer = duration, minutes, seconds;
				setInterval(function () {
					minutes = parseInt(timer / 60, 10);
					seconds = parseInt(timer % 60, 10);
					minutes = minutes < 10 ? "0" + minutes : minutes;
					seconds = seconds < 10 ? "0" + seconds : seconds;
					display.textContent = minutes + ":" + seconds;
					if (--timer < 0) {
						timer = duration;
					}
				}, 1000);
			}
			window.onload = function () {
				
			};
		
		})
	
	</script>
    <!-- Mobile Sidebar Overlay -->
    <div id="sidebar-overlay-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden md:hidden"></div>
</body>
</body>
</html>